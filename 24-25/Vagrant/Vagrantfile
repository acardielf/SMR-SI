# -*- mode: ruby -*-
# vi: set ft=ruby :

# All Vagrant configuration is done below. The "2" in Vagrant.configure
# configures the configuration version (we support older styles for
# backwards compatibility). Please don't change it unless you know what
# you're doing.
Vagrant.configure("2") do |config|
  # The most common configuration options are documented and commented below.
  # For a complete reference, please see the online documentation at
  # https://docs.vagrantup.com.

  # Every Vagrant development environment requires a box. You can search for
  # boxes at https://vagrantcloud.com/search.


  config.vm.define "ubuntu" do |ubuntu|
    # Configuraci√≥n de red privada 
    ubuntu.vm.box = "ubuntu/bionic64"
    ubuntu.vm.hostname = "gui"
    ubuntu.vm.network "private_network", ip: "192.168.56.103"

    ubuntu.vm.provider "virtualbox" do |v|
      v.gui = true
      v.memory = 2048
    end

    ubuntu.vm.provision "shell", inline: <<-SHELL
      useradd -m -s /bin/bash user
      echo "user:user" | chpasswd
      echo "PasswordAuthentication yes" | sudo tee -a /etc/ssh/sshd_config
      echo "PermitRootLogin yes" | sudo tee -a /etc/ssh/sshd_config
      sudo systemctl restart sshd            
    SHELL
    
    ubuntu.vm.provision "shell", inline: "sudo sed -i 's/^# deb/deb/g' /etc/apt/sources.list" 
    ubuntu.vm.provision "shell", inline: "sudo apt-get update && sudo apt-get upgrade -y"
    ubuntu.vm.provision "shell", inline: "sudo loadkeys es"
    ubuntu.vm.provision "shell", inline: "sudo apt-get install -y gnome-session gdm3 xterm firefox"
    ubuntu.vm.provision "shell", inline: "sudo sed -i 's/XKBLAYOUT=\"us\"/XKBLAYOUT=\"es\"/g' /etc/default/keyboard" 
    ubuntu.vm.provision "shell", inline: "sudo apt-get install -y virtualbox-guest-dkms virtualbox-guest-utils virtualbox-guest-x11"
    ubuntu.vm.provision "shell", inline: "sudo shutdown -r now"

  end

  config.vm.define "exweb" do |exweb|
    exweb.vm.box = "ubuntu/bionic64"
    exweb.vm.hostname = "exweb"
    exweb.vm.network "private_network", ip: "192.168.56.101"
  
    exweb.vm.provision "shell", inline: <<-SHELL
      useradd -m -s /bin/bash user
      echo "user:user" | chpasswd
    SHELL
  
    exweb.vm.provision "shell", inline: <<-SHELL
      apt-get update
      apt-get install -y apache2
      systemctl enable apache2
      systemctl start apache2
      echo "PasswordAuthentication yes" | sudo tee -a /etc/ssh/sshd_config
      echo "PermitRootLogin yes" | sudo tee -a /etc/ssh/sshd_config
      sudo systemctl restart sshd      
    SHELL
  end

  config.vm.define "exdb" do |exdb|
    exdb.vm.box = "ubuntu/bionic64"
    exdb.vm.hostname = "exdb"  
    exdb.vm.network "private_network", ip: "192.168.56.102"
  
    exdb.vm.provision "shell", inline: <<-SHELL
      useradd -m -s /bin/bash user
      echo "user:user" | chpasswd
      echo "PasswordAuthentication yes" | sudo tee -a /etc/ssh/sshd_config
      echo "PermitRootLogin yes" | sudo tee -a /etc/ssh/sshd_config
      sudo systemctl restart sshd
    SHELL
  
    exdb.vm.provision "shell", inline: <<-SHELL
      apt-get update
      apt-get install -y apache2
      systemctl enable apache2
      systemctl start apache2
    SHELL
  end

  
    
end
